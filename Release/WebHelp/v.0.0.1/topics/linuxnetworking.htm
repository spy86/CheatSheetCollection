<!DOCTYPE HTML>
<html id="hs-topic-p">
<!-- saved from url=(0025)http://www.helpsmith.com/ -->
<head>
<title>LinuxNetworking</title>
<meta charset="windows-1250" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="generator" content="HelpSmith 8.0 (Build 18.1202)" />
<style type="text/css" media="screen">
html {
  height: 100%;
}
body {
  margin: 0 8px 0 8px;
}
</style>
<link type="text/css" rel="stylesheet" href="../css/topics/style.css" />
<script type="text/javascript" src="../js/jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="../js/settings.js?1845a896"></script>
<script type="text/javascript" src="../js/core.min.js?392d0f49"></script>
<script type="text/javascript" src="../js/topic.min.js?392d0f49"></script>
<script type="text/javascript">
	var topicContext = 430;
</script>
</head>
<body>
<p class="ps0"><span class="ts0">Basics</span></p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">netcat Commands</span></p>
<p class="ps2"><span class="ts8">nc -l -p &lt;port&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # Listen on port</span><br /><span class="ts8">nc -w3 &lt;ip&gt; &lt;port&gt;&nbsp; # Listen for connection from IP on port</span><br /><br /><span class="ts8"># Search banners</span><br /><span class="ts8">echo | nc -v -n -w1 &lt;ip&gt; &lt;port min&gt;-&lt;port max&gt;</span><br /><br /><span class="ts8"># Port scan</span><br /><span class="ts8">nc â&euro;&ldquo;v â&euro;&ldquo;n â&euro;&ldquo;z â&euro;&ldquo;w1 &lt;ip&gt; &lt;port min&gt;-&lt;port max&gt;</span><br />&nbsp;</p>
<p class="ps1"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><a href="http://packetlife.net/library/cheat-sheets/" class="hs0">paketlife.net cheet sheets</a><span class="ts2">&nbsp;for all network protocols (PDFs)</span></p>
<p class="ps0"><span class="ts0">DNS</span></p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">Resolve a name via nsswitch</span></p>
<p class="ps2"><span class="ts8">getent hosts &lt;host name&gt;</span><br />&nbsp;</p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><a href="http://www.cloudshark.org" class="hs0">CloudShark</a><span class="ts2">: Sharing network traces</span></p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">DNS Lookup</span></p>
<p class="ps2"><span class="ts8">dig &lt;domain&gt;</span><br /><span class="ts8">dig &lt;domain&gt; +noall +answer</span><br /><span class="ts8">dig &lt;domain&gt; +short</span><br /><span class="ts8">dig MX &lt;domain&gt;</span><br /><span class="ts8">dig NS &lt;domain&gt;</span><br /><span class="ts8">dig ANY &lt;domain&gt;</span><br /><br /><span class="ts8">dig -x &lt;IP&gt;</span><br /><span class="ts8">dig -x &lt;IP&gt; +short</span><br /><br /><span class="ts8">dig @8.8.8.8 &lt;domain&gt;</span><br /><br /><span class="ts8">dig -f input.txt +noall +answer</span><br />&nbsp;</p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">DNS RR - warpsrv: CLI wrapper for DNS RR connections</span></p>
<p class="ps2"><span class="ts8">&nbsp; apt-get install -y wrapsrv netcat</span><br /><span class="ts8">&nbsp; export eval $(wrapsrv &lt;DNS name&gt; &quot;netcat -z %h %p &amp;&amp; echo http_proxy=http://%h:%p&quot;)</span><br />&nbsp;</p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><a href="https://dnssec-debugger.verisignlabs.com/" class="hs0">DNSSEC - Verisign Online Tester</a></p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">DNS - </span><a href="https://sslmate.com/caa/support" class="hs0">CAA Support</a><span class="ts2">: Providers and Tools</span></p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">DNS Servers</span></p>
<p class="ps13"><span style="font-family: 'Courier New'; font-size: 10pt; color: Black">o</span><span style="display: inline-block; width: 22px"></span><span class="ts2">Bind</span></p>
<p class="ps13"><span style="font-family: 'Courier New'; font-size: 10pt; color: Black">o</span><span style="display: inline-block; width: 22px"></span><span class="ts2">PowerDNS</span></p>
<p class="ps13"><span style="font-family: 'Courier New'; font-size: 10pt; color: Black">o</span><span style="display: inline-block; width: 22px"></span><span class="ts2">NSD</span></p>
<p class="ps13"><span style="font-family: 'Courier New'; font-size: 10pt; color: Black">o</span><span style="display: inline-block; width: 22px"></span><span class="ts2">ldns</span></p>
<p class="ps22"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">DNS over HTTPS resolvers</span></p>
<p class="ps13"><span style="font-family: 'Courier New'; font-size: 10pt; color: Black">o</span><span style="display: inline-block; width: 22px"></span><a href="https://dnsprivacy.org/wiki/display/DP/DNS+Privacy+Daemon+-+Stubby" class="hs0">stubby</a></p>
<p class="ps13"><span style="font-family: 'Courier New'; font-size: 10pt; color: Black">o</span><span style="display: inline-block; width: 22px"></span><a href="https://developers.cloudflare.com/1.1.1.1/dns-over-https/cloudflared-proxy/" class="hs0">cloudflared</a></p>
<p class="ps13"><span style="font-family: 'Courier New'; font-size: 10pt; color: Black">o</span><span style="display: inline-block; width: 22px"></span><a href="https://github.com/dimkr/nss-tls" class="hs0">nss-tls</a></p>
<p class="ps0"><span class="ts0">Configuration</span></p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">ethtool - Usage</span></p>
<p class="ps2"><span class="ts8">ethtool eth0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # Print general info on eth0</span><br /><span class="ts8">ethtool -i eth0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # Print kernel module info</span><br /><span class="ts8">ethtool -S eth0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # Print eth0 traffic statistics</span><br /><span class="ts8">ethtool -a eth0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # Print RX, TX and auto-negotiation settings</span><br /><span class="ts8">ethtool -p eth0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # Blink LED</span><br /><br /><span class="ts8"># Changing NIC settings...</span><br /><span class="ts8">ethtool -s eth0 speed 100</span><br /><span class="ts8">ethtool -s eth0 autoneg off</span><br /><span class="ts8">ethtool -s eth0 duplex full</span><br /><span class="ts8">ethtool -s eth0 wol g&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # Turn on wake-on-LAN</span><br />&nbsp;</p>
<p class="ps2"><span class="ts2">Do not forget to make changes permanent in e.g. /etc/network/interfaces.</span></p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">ip - Usage</span></p>
<p class="ps2"><span class="ts8">ip link show</span><br /><span class="ts8">ip link set eth0 up</span><br /><span class="ts8">ip addr show</span><br /><span class="ts8">ip neigh show</span><br />&nbsp;</p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">miitool - Show Link Infos</span></p>
<p class="ps2"><span class="ts8"># mii-tool -v</span><br /><span class="ts8">eth0: negotiated 100baseTx-FD flow-control, link ok</span><br /><span class="ts8">&nbsp; product info: vendor 00:07:32, model 17 rev 4</span><br /><span class="ts8">&nbsp; basic mode:&nbsp;&nbsp; autonegotiation enabled</span><br /><span class="ts8">&nbsp; basic status: autonegotiation complete, link ok</span><br /><span class="ts8">&nbsp; capabilities: 1000baseT-HD 1000baseT-FD 100baseTx-FD 100baseTx-HD 10baseT-FD 10baseT-HD</span><br /><span class="ts8">&nbsp; advertising:&nbsp; 100baseTx-FD 100baseTx-HD 10baseT-FD 10baseT-HD flow-control</span><br /><span class="ts8">&nbsp; link partner: 1000baseT-HD 1000baseT-FD 100baseTx-FD 100baseTx-HD 10baseT-FD 10baseT-HD flow-control</span><br />&nbsp;</p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">Enable Jumbo Frames</span></p>
<p class="ps2"><span class="ts8">ifconfig eth1 mtu 9000</span><br />&nbsp;</p>
<p class="ps1"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><a href="https://speakerdeck.com/gnb/130-lca2008-nfs-tuning-secrets-d7" class="hs0">NFS - Tuning Secrets</a><span class="ts2">: SGI Slides on NFS Performance</span></p>
<p class="ps7"><span class="ts3">iptables</span></p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><a href="http://daemonkeeper.net/781/mass-blocking-ip-addresses-with-ipset/" class="hs0">ipsets vs. iptables Performance</a></p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><a href="http://utcc.utoronto.ca/~cks/space/blog/linux/IptablesIpsetNotes" class="hs0">ipsets - Using IP sets for simpler iptables rules</a></p>
<p class="ps2"><span class="ts8">ipset create smtpblocks hash:net counters</span><br /><span class="ts8">ipset add smtpblocks 27.112.32.0/19</span><br /><span class="ts8">ipset add smtpblocks 204.8.87.0/24</span><br /><span class="ts8">iptables -A INPUT -p tcp --dport 25 -m set --match-set smtpblocks src -j DROP</span><br />&nbsp;</p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">iptables - Loopback Routing:</span></p>
<p class="ps2"><span class="ts8">iptables -t nat -A POSTROUTING -d &lt;internal web server IP&gt; -s &lt;internal network address&gt; -p tcp --dport 80 -j SNAT --to-source &lt;external web server IP&gt;</span><br />&nbsp;</p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">iptables - Show active rules:</span></p>
<p class="ps2"><span class="ts8">iptables -S</span><br /><span class="ts8">iptables -L </span><br /><span class="ts8">iptables -L &lt;table&gt;</span><br />&nbsp;</p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">iptables - Full flush:</span></p>
<p class="ps2"><span class="ts8">iptables -F</span><br /><span class="ts8">iptables -X</span><br /><span class="ts8">iptables -t nat -F</span><br /><span class="ts8">iptables -t nat -X</span><br /><span class="ts8">iptables -t mangle -F</span><br /><span class="ts8">iptables -t mangle -X</span><br /><span class="ts8">iptables -P INPUT ACCEPT</span><br /><span class="ts8">iptables -P FORWARD ACCEPT</span><br /><span class="ts8">iptables -P OUTPUT ACCEPT</span><br />&nbsp;</p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">iptables - Allow established:</span></p>
<p class="ps2"><span class="ts8">iptables -A INPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT</span><br />&nbsp;</p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">iptables - Log failed requests:</span></p>
<p class="ps2"><span class="ts8">iptables -I INPUT 5 -m limit --limit 5/min -j LOG --log-prefix &quot;iptables denied: &quot; --log-level 7</span><br />&nbsp;</p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">iptables - Persistency on Debian:</span></p>
<p class="ps2"><span class="ts8">apt-get install iptables-persistent</span><br /><br /><span class="ts8"># Set some rules and call</span><br /><span class="ts8">invoke-rc.d iptables-persistent save</span><br />&nbsp;</p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><a href="https://wiki.ubuntu.com/UncomplicatedFirewall" class="hs0">iptables - Persistency on Ubuntu: UFW</a><span class="ts2">&nbsp;(Uncomplicated FireWall)</span></p>
<p class="ps2"><span class="ts8">ufw enable</span><br /><span class="ts8">ufw status</span><br /><span class="ts8">ufw allow ssh/tcp</span><br /><span class="ts8">ufw allow from &lt;IP&gt; proto tcp to any port &lt;port&gt;</span><br /><span class="ts8">ufw delete allow from &lt;IP&gt; proto tcp to any port &lt;port&gt;</span><br />&nbsp;</p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">fail2ban CLI Commands</span></p>
<p class="ps1"><span class="ts8">fail2ban-client status</span><br /><span class="ts8">fail2ban-client status &lt;jail name&gt;</span><br />&nbsp;</p>
<p class="ps0"><span class="ts0">Troubleshooting</span></p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">Black Hole Route: To block IPs create route on loopback</span></p>
<p class="ps2"><span class="ts8">&nbsp; route add -net 91.65.16.0/24 gw 127.0.0.1 lo&nbsp;&nbsp; # for a subnet</span><br /><span class="ts8">&nbsp; route add&nbsp; 91.65.16.4 gw 127.0.0.1 lo&nbsp;&nbsp; # for a single IP</span><br />&nbsp;</p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">Quick Access Log IP Top List</span></p>
<p class="ps2"><span class="ts8">&nbsp; tail -100000 access.log | awk '{print $1}' | sort | uniq -c |sort -nr|head -25</span><br />&nbsp;</p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">Find out if IP is used before configuring it</span></p>
<p class="ps2"><span class="ts8">&nbsp; arping &lt;IP&gt;</span><br />&nbsp;</p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">Traceroute with AS and network name lookup</span></p>
<p class="ps2"><span class="ts8">&nbsp; lft -AN www.google.de</span><br />&nbsp;</p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">Manually lookup AS</span></p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><a href="http://www.dailychanges.com/" class="hs0">dailychanges.com</a><span class="ts2">: Tracks DNS changes</span></p>
<p class="ps1"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><a href="https://russ.garrett.co.uk/2009/01/01/linux-kernel-tuning/" class="hs0">Tuning network settings</a></p>
<p class="ps0"><span class="ts0">Measuring</span></p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">vnstat - Short term measurement bytes/packets min/avg/max:</span></p>
<p class="ps2"><span class="ts8">vnstat -l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # Live listing until Ctrl-C and summary</span><br /><span class="ts8">vnstat -tr&nbsp;&nbsp;&nbsp;&nbsp; # 5s automatic traffic sample</span><br />&nbsp;</p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">vnstat - Long term statistics:</span></p>
<p class="ps1"><span class="ts8">vnstat -h&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # last hours (including ASCII graph)</span><br /><span class="ts8">vnstat -d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # last days</span><br /><span class="ts8">vnstat -w&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # last weeks</span><br /><span class="ts8">vnstat -m&nbsp;&nbsp;&nbsp;&nbsp; # last months</span><br /><br /><span class="ts8">vnstat -t&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # top 10 days</span><br />&nbsp;</p>
<p class="ps7"><span class="ts3">Using curl metrics</span></p>
<p class="ps5"><span class="ts2">You can use curl to measure resolving, time to connect, time to first byte and total time like this:</span></p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">Issue sequential requests (each with new connection)</span></p>
<p class="ps5"><span class="ts2">&lt;pre&gt; while true; do curl -w &quot;$(date +%FT%T) dns %{time_namelookup} connect %{time_connect} firstbyte %{time_starttransfer} total %{time_total} HTTP %{http_code}\n&quot; -o /dev/null -s &quot;https://example.com&quot; sleep 1 done&lt;/pre&gt;</span></p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">Issue sequential HTTP/1.1 requests on 1 connection</span></p>
<p><span class="ts2">&lt;pre&gt; curl -w &quot;$(date +%FT%T) dns %{time_namelookup} connect %{time_connect} firstbyte %{time_starttransfer} total %{time_total} HTTP %{http_code}\n&quot; --keepalive -K &lt;(printf 'url=&quot;https://example.com/&quot;\n%.0s' {1..10000}) &lt;/pre&gt;</span></p>
<p class="ps0"><span class="ts0">Discovery</span></p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">LLDP</span></p>
<p class="ps2"><span class="ts8">lldpctl</span><br /><span class="ts8">lldpctl eth0</span><br />&nbsp;</p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">nmap commands</span></p>
<p class="ps1"><span class="ts8"># Network scan</span><br /><span class="ts8">nmap -sP 192.168.0.0/24</span><br /><br /><span class="ts8"># Host scan</span><br /><span class="ts8">nmap &lt;ip&gt;</span><br /><span class="ts8">nmap -F &lt;ip&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # fast</span><br /><span class="ts8">nmap -O &lt;ip&gt;&nbsp;&nbsp;&nbsp;&nbsp; # detect OS</span><br /><span class="ts8">nmap -sV &lt;ip&gt;&nbsp;&nbsp;&nbsp;&nbsp; # detect services and versions</span><br /><span class="ts8">nmap -sU &lt;ip&gt;&nbsp;&nbsp;&nbsp;&nbsp; # detect UDP services</span><br /><br /><span class="ts8"># Alternative host discovery</span><br /><span class="ts8">nmap -PS &lt;ip&gt;&nbsp;&nbsp;&nbsp;&nbsp; # TCP SYN scan</span><br /><span class="ts8">nmap -PA &lt;ip&gt;&nbsp;&nbsp;&nbsp;&nbsp; # TCP ACK scan</span><br /><span class="ts8">nmap -PO &lt;ip&gt;&nbsp;&nbsp;&nbsp;&nbsp; # IP ping</span><br /><span class="ts8">nmap -PU &lt;ip&gt;&nbsp;&nbsp;&nbsp;&nbsp; # UDP ping</span><br /><br /><span class="ts8"># Alternative service discovery</span><br /><span class="ts8">nmap -sS &lt;ip&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><br /><span class="ts8">nmap -sT &lt;ip&gt;</span><br /><span class="ts8">nmap -sA &lt;ip&gt;</span><br /><span class="ts8">nmap -sW &lt;ip&gt;</span><br /><br /><span class="ts8"># Checking firewalls</span><br /><span class="ts8">nmap -sN &lt;ip&gt;</span><br /><span class="ts8">nmap -sF &lt;ip&gt;</span><br /><span class="ts8">nmap -sX &lt;ip&gt;</span><br />&nbsp;</p>
<p class="ps0"><span class="ts0">Debugging</span></p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><a href="http://x-trace.net/pubs/nsdi-html/xtrace.html" class="hs0">X-Trace - Multi-protocol tracing framework</a></p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">iptraf - Real-time statistics in ncurses interfaces</span></p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">mtr - Debug routing/package loss issues</span></p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">netstat - The different modes</span></p>
<p class="ps2"><span class="ts8"># Typically used modes</span><br /><span class="ts8">netstat -rn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # List routes</span><br /><span class="ts8">netstat -tlnp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # List all open TCP connections</span><br /><span class="ts8">netstat -tlnpc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # Continuously do the above</span><br /><span class="ts8">netstat -tulpen&nbsp;&nbsp;&nbsp; # Extended connection view</span><br /><span class="ts8">netstat -a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # List all sockets</span><br /><br /><span class="ts8"># And more rarely used</span><br /><span class="ts8">netstat -s&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # List per protocol statistics</span><br /><span class="ts8">netstat -su&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # List UDP statistics</span><br /><span class="ts8">netstat -M&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # List masqueraded connections</span><br /><span class="ts8">netstat -i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # List interfaces and counters</span><br /><span class="ts8">netstat -o&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # Watch time/wait handling</span><br />&nbsp;</p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">nttcp - TCP performance testing</span></p>
<p class="ps2"><span class="ts8"># On sending host</span><br /><span class="ts8">nttcp -t -s</span><br /><br /><span class="ts8"># On receiving host</span><br /><span class="ts8">nttcp -r -s</span><br />&nbsp;</p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">List Kernel Settings</span></p>
<p class="ps2"><span class="ts8">sysctl net</span><br />&nbsp;</p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><a href="http://net-snmp.sourceforge.net/wiki/index.php/TUT:snmpwalk" class="hs0">SNMP - Dump all MIBs</a><span class="ts2">: When you need to find the MIB for an object known only by name try</span></p>
<p class="ps2"><span class="ts8">snmpwalk -c public -v 1 -O s &lt;myhost&gt; .iso | grep &lt;search string&gt;</span><br />&nbsp;</p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><a href="http://bgp.he.net/" class="hs0">Hurricane Electric - BGP Tools</a><span class="ts2">: Statistics on all AS as well as links to their looking glasses.</span></p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">tcpdump - Be verbose and print full package hex dumps:</span></p>
<p class="ps2"><span class="ts8">&nbsp;tcpdump -i eth0 -nN -vvv -xX -s 1500 port &lt;some port&gt;</span><br />&nbsp;</p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><span class="ts2">tcpdump - Non-promiscuous mode to list only traffic that the network stack processes:</span></p>
<p class="ps2"><span class="ts8">tcpdump -e ...</span><br />&nbsp;</p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><a href="http://delicious.com/redirect?url=http://dmiessler.com/study/tcpdump/" class="hs0">tcpdump - Tutorial</a><span class="ts2">: Many usage examples.</span></p>
<p class="ps2"><span class="ts8"># Filter port</span><br /><span class="ts8">tcpdump port 80</span><br /><span class="ts8">tcpdump src port 1025 </span><br /><span class="ts8">tcpdump dst port 389</span><br /><span class="ts8">tcpdump portrange 21-23</span><br /><br /><span class="ts8"># Filter source or destination IP</span><br /><span class="ts8">tcpdump src 10.0.0.1</span><br /><span class="ts8">tcpdump dest 10.0.0.2</span><br /><br /><span class="ts8"># Filter&nbsp; everything on network </span><br /><span class="ts8">tcpdump net 1.2.3.0/24</span><br /><br /><span class="ts8"># Logically operators</span><br /><span class="ts8">tcpdump src port 1025 and tcp </span><br /><br /><span class="ts8"># Provide full hex dump of captured HTTP packages</span><br /><span class="ts8">tcpdump -s0 -x port 80</span><br /><br /><span class="ts8"># Filter TCP flags (e.g. RST)</span><br /><span class="ts8">tcpdump 'tcp[13] &amp; 4!=0'</span><br />&nbsp;</p>
<p class="ps2"><span style="font-size: 14pt; line-height: 0; vertical-align: middle; color: Black">&bull;</span><span style="display: inline-block; width: 24px"></span><a href="https://unix4lyfe.org/darkstat/" class="hs0">darkstat</a><span class="ts2">&nbsp;- libpcap monitoring</span></p>
<p class="ps3"><br /></p>
<div>
  <hr class="hline0" />
</div>
<p class="ps4"><span class="ts1">Created with an evaluation copy of HelpSmith.</span><br /><span class="ts1">To remove this notice, you should </span><a href="http://www.helpsmith.com/buynow.php" target="_blank" class="hs1">purchase the full version</a><span class="ts1">&nbsp;of the product.</span></p>
</body>
</html>